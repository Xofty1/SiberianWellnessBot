# Telegram Бот с Предобученными Данными

Этот бот для Telegram обучается на ваших собственных данных (PDF-файлы, изображения, текст) и может отвечать на вопросы на основе этой информации.

## Возможности

- Предварительное обучение на данных из PDF, изображений и текстовых файлов
- Поиск релевантной информации по запросу пользователя
- Генерация ответов с использованием контекста из ваших данных

## Установка

1. Клонируйте репозиторий
2. Создайте виртуальное окружение и активируйте его:
   ```
   python -m venv .venv
   # На Windows:
   .venv\Scripts\activate
   # На Linux/Mac:
   source .venv/bin/activate
   ```
3. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```
4. Установите Tesseract OCR (для обработки изображений):
   - Для Windows: скачайте и установите с https://github.com/UB-Mannheim/tesseract/wiki
   - Для Linux: `sudo apt-get install tesseract-ocr`
   - Для macOS: `brew install tesseract`
5. Создайте файл `config.py` с токенами:
   ```python
   TG_TOKEN = "ваш_токен_телеграм"
   AI_TOKEN = "ваш_токен_openai_или_openrouter"
   ```

## Подготовка данных

1. Создайте следующую структуру директорий:
   ```
   training_data/
   ├── pdf/        # Положите сюда PDF файлы
   ├── images/     # Положите сюда изображения
   └── text/       # Положите сюда текстовые файлы
   ```

2. Поместите ваши данные в соответствующие директории

3. Запустите обработку данных:
   ```
   python train_bot.py
   ```

## Управление базой знаний

Для управления базой знаний используйте скрипт `manage_knowledge.py`:

1. Просмотр содержимого базы знаний:
   ```
   python manage_knowledge.py list
   ```

2. Очистка базы знаний:
   ```
   python manage_knowledge.py clear
   ```

3. Тестирование поиска в базе знаний:
   ```
   python manage_knowledge.py test "ваш поисковый запрос"
   ```

## Запуск бота

После обработки данных запустите бота:
```
python run.py
```

## Как работает бот

1. При загрузке бот обрабатывает все данные и строит базу знаний
2. Когда пользователь задает вопрос, бот ищет релевантную информацию в базе знаний
3. Если находит совпадение, использует это как контекст для генерации ответа
4. Если релевантной информации нет, просто отвечает на вопрос

## Примечания по использованию

- Добавляйте новые данные в соответствующие папки и запускайте `train_bot.py` для обновления базы знаний
- Бот автоматически загружает базу знаний при запуске
- Если бот не находит релевантную информацию, он ответит на вопрос без использования вашего контекста
- Для работы с OpenAI API или OpenRouter требуется API ключ

## Устранение неполадок

Если возникают ошибки с библиотекой OpenAI, попробуйте установить более раннюю версию:
```
pip install openai==1.6.1
```

Для правильной работы Tesseract OCR убедитесь, что он установлен и доступен в PATH системы. 